Tasks=new Mongo.Collection("tasks"),Meteor.isClient&&(Template.body.helpers({tasks:function(){return Session.get("hideCompleted")?Tasks.find({checked:{$ne:!0}},{sort:{createdAt:-1}}):Tasks.find({},{sort:{createdAt:-1}})},hideCompleted:function(){return Session.get("hideCompleted")},incompleteCount:function(){return Tasks.find({checked:{$ne:!0}}).count()}}),Template.body.events({"submit .new-task":function(e){var t=e.target.text.value;return Tasks.insert({text:t,createdAt:new Date,owner:Meteor.userId(),username:Meteor.user().username}),e.target.text.value="",!1},"change .hide-completed input":function(e){Session.set("hideCompleted",e.target.checked)}}),Template.task.events({"click .toggle-checked":function(){Tasks.update(this._id,{$set:{checked:!this.checked}})},"click .delete":function(){Tasks.remove(this._id)}}),Accounts.ui.config({passwordSignupFields:"USERNAME_ONLY"})),Meteor.methods({addTask:function(e){if(!Meteor.userId())throw new Meteor.Error("not-authorized");Tasks.insert({text:e,createdAt:new Date,owner:Meteor.userId(),username:Meteor.user().username})},deleteTask:function(e){Tasks.remove(e)}});